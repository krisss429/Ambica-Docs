$serviceName = "YourServiceName"
$gMSA = "domain\gMSA$"

# Stop the service
Stop-Service -Name $serviceName

# Change the service account to the gMSA
$service = Get-WmiObject -Class Win32_Service -Filter "Name='$serviceName'"
$service.Change($null, $null, $null, $null, $null, $gMSA, $null)

# Set the password to null
$nullPassword = ConvertTo-SecureString -AsPlainText -Force -String ""
Set-Service -Name $serviceName -Credential (New-Object System.Management.Automation.PSCredential($gMSA, $nullPassword))

# Start the service
Start-Service -Name $serviceName


Verify the Service Configuration:

Verify that the service is configured correctly and running under the gMSA.


Get-Service -Name YourServiceName | Select-Object -Property Name, StartType, Status
